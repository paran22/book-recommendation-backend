## 감정 기반 도서 추천 서비스

### 추천 전 사전 질문

**1. 현재 감정 상태 파악**
Q: "지금 당신의 기분을 가장 잘 설명하는 단어는 무엇인가요?"
A: 행복함, 지침, 불안함, 우울함, 설렘, 혼란스러움 등

**2. 원하는 감정적 효과**
Q: "지금 이 책을 통해 어떤 감정을 경험하고 싶으신가요?"
A: 현실 도피하고 싶은지
공감받고 싶은지
위로받고 싶은지
영감과 동기부여를 얻고 싶은지
새로운 시각이 필요한지

**3. 직업 정보**
Q: "현재 어떤 직업을 가지고 계신가요?"
A: 학생, 직장인, 프리랜서, 주부, 구직자 등

**4. 현재 상황/컨텍스트**
Q: "지금 어떤 상황에서 독서를 하실 예정인가요?"
A: 잠들기 전 휴식
이동 중 짧은 시간
주말 여유로운 시간
스트레스 해소를 위한 시간

**5. 집중도/몰입도 선호**
Q: "지금 어느 정도의 집중도가 필요한 책을 원하시나요?"
A: 가볍게 읽을 수 있는 책
깊은 사고가 필요한 책
빠르게 몰입할 수 있는 책

### RAG 데이터

- 국립중앙도서관 사서추천도서 (./data/library_books.json)
- 사용자가 읽은 책 정보 (./data/test-case/user_reading_history.json)
- 사용자의 책 취향 정보 (./data/test-case/user_reading_preferences.json)

### 테스트 방법

#### 테스트 시나리오

**TestCase1: "불안감을 느끼는 직장인"**
질문 1 응답: "불안함"
질문 2 응답: "위로와 안정감을 원함"
질문 3 응답: "직장인"
질문 4 응답: "잠들기 전 독서"
질문 5 응답: "가볍게 읽을 수 있는 책"

**TestCase2: "우울한 학생"**
질문 1 응답: "우울함"
질문 2 응답: "위로와 안정감을 원함"
질문 3 응답: "학생"
질문 4 응답: "이동 중 짧은 시간"
질문 5 응답: "빠르게 몰입할 수 있는 책"

### LLM 모델

**공통 프롬프트**

- 역할 부여 : 책 추천 전문가
- COT: 평가 척도 → 근거 있는 추천 이유 작성 → 감정적 효과 설명 등 일련의 의사결정 과정 요구
- 출력 포맷 지정

**방법1: RAG 기반 추천 로직**

1. 사용자의 취향 정보, 사용자의 독서 이력 벡터 db에서 질문과 유사한 정보 검색
2. 검색된 정보를 바탕으로 강화된 질문 생성
3. 강화된 질문으로 도서 정보 벡터 db에서 유사한 도서 검색
4. 프롬프트에 검색된 도서 정보를 포함하여 추천 도서 선정

**방법2: 프롬프트 기반 추천 로직**

1. 도서 정보 벡터 db에서 질문과 유사한 도서 검색
2. 프롬프트에 사용자의 취향 정보, 사용자의 독서 이력, 검색된 도서 정보를 포함하여 추천 도서 선정

### 평가 방법

1. 추천 도서를 알라딘 API를 통해 상세 정보 검색
2. 검색된 도서 정보를 포함해 평가용 프롬프트 생성
3. Claude 3.7을 통해 평가 진행

- 0~5점 사이로 적합도 평가(존재하지 않는 책의 경우 0점)하고 평균 계산

| 모델        | 방법                 | 추천 도서 후보군 수(num_candidates) | 평균 적합도 | prompt_tokens | completion_tokens | total_cost   |
| ----------- | -------------------- | ----------------------------------- | ----------- | ------------- | ----------------- | ------------ |
| gpt-4o-mini | RAG 기반(방법1)      | 6                                   | 4.77        | 1769          | 417               | 0.0005155499 |
| gpt-4o-mini | 프롬프트 기반(방법2) | 6                                   | 3           | 5747          | 442               | 0.00112725   |
